---
title: "Screener"
output: html_document
---

```{r}
require(rstan)
require(tidyverse)
sm = stan_model("screener.stan")
1
```

```{r}
require(tidyverse)
data_dir = "/gpfs/commons/groups/knowles_lab/Cas13Karin/analysis/"
dat = read_tsv(paste0(data_dir,"Cas13_essential_arm_foldchanges.txt"))

day21 = dat %>% 
  filter(day == "day21") %>% 
  select(-day, -week)

day21 = day21 %>% 
  mutate(sgrna = factor(sgrna), 
         Gene = factor(gene))
```

```{r}
sam = sampling(sm, data = list(
  efficacy_prior_a = .5, 
  efficacy_prior_b = .5, 
  sigma_noise = 1, 
  sigma_prior = 2, 
  N = nrow(day21),
  y = day21$value, 
  which_guide = as.integer(day21$sgrna), 
  which_junction = as.integer(day21$Gene), 
  num_guides = length(levels(day21$sgrna)), 
  num_junctions = length(levels(day21$sgrna))
))
```

```{r}

```
